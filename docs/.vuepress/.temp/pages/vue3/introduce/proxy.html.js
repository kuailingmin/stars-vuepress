import comp from "/Users/kuailingmin/Desktop/创业/stars-vuepress/docs/.vuepress/.temp/pages/Vue3/Introduce/proxy.html.vue"
const data = JSON.parse("{\"path\":\"/Vue3/Introduce/proxy.html\",\"title\":\"Proxy\",\"lang\":\"zh-CN\",\"frontmatter\":{},\"headers\":[{\"level\":2,\"title\":\"回顾vue2响应式设计的实现\",\"slug\":\"回顾vue2响应式设计的实现\",\"link\":\"#回顾vue2响应式设计的实现\",\"children\":[]},{\"level\":2,\"title\":\"vue3响应式设计的实现\",\"slug\":\"vue3响应式设计的实现\",\"link\":\"#vue3响应式设计的实现\",\"children\":[]},{\"level\":2,\"title\":\"总结\",\"slug\":\"总结\",\"link\":\"#总结\",\"children\":[]}],\"git\":{\"updatedTime\":null,\"contributors\":[]},\"filePathRelative\":\"Vue3/Introduce/proxy.md\",\"excerpt\":\"\\n<div class=\\\"custom-container tip\\\"><p class=\\\"custom-container-title\\\">说明</p>\\n<p>之前Vue2.x 中基于 Object.defineProperty 的实现所存在的很多限制：无法监听 属性的添加和删除、数组索引和长度的变更，并可以支持 Map、Set、WeakMap 和 WeakSet,现在Vue3.x放弃使用了Object.defineProperty而选择了使用更快的原生Proxy</p>\\n</div>\\n<h2>回顾vue2响应式设计的实现</h2>\\n<div class=\\\"language-javascript line-numbers-mode\\\" data-highlighter=\\\"prismjs\\\" data-ext=\\\"js\\\" data-title=\\\"js\\\"><pre><code><span class=\\\"line\\\"> <span class=\\\"token keyword\\\">let</span> childOb <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">!</span>shallow <span class=\\\"token operator\\\">&amp;&amp;</span> <span class=\\\"token function\\\">observe</span><span class=\\\"token punctuation\\\">(</span>val<span class=\\\"token punctuation\\\">)</span></span>\\n<span class=\\\"line\\\"> <span class=\\\"token comment\\\">// 对 data中的数据进行深度遍历，给对象的每个属性添加响应式</span></span>\\n<span class=\\\"line\\\">  Object<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">defineProperty</span><span class=\\\"token punctuation\\\">(</span>obj<span class=\\\"token punctuation\\\">,</span> key<span class=\\\"token punctuation\\\">,</span> <span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">    <span class=\\\"token literal-property property\\\">enumerable</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">,</span></span>\\n<span class=\\\"line\\\">    <span class=\\\"token literal-property property\\\">configurable</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token boolean\\\">true</span><span class=\\\"token punctuation\\\">,</span></span>\\n<span class=\\\"line\\\">    <span class=\\\"token function-variable function\\\">get</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">reactiveGetter</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">      <span class=\\\"token keyword\\\">const</span> value <span class=\\\"token operator\\\">=</span> getter <span class=\\\"token operator\\\">?</span> <span class=\\\"token function\\\">getter</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">call</span><span class=\\\"token punctuation\\\">(</span>obj<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">:</span> val</span>\\n<span class=\\\"line\\\">      <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>Dep<span class=\\\"token punctuation\\\">.</span>target<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">         <span class=\\\"token comment\\\">// 进行依赖收集</span></span>\\n<span class=\\\"line\\\">        dep<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">depend</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>childOb<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">          childOb<span class=\\\"token punctuation\\\">.</span>dep<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">depend</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span></span>\\n<span class=\\\"line\\\">          <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>Array<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">isArray</span><span class=\\\"token punctuation\\\">(</span>value<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">            <span class=\\\"token comment\\\">// 是数组则需要对每一个成员都进行依赖收集，如果数组的成员还是数组，则递归。</span></span>\\n<span class=\\\"line\\\">            <span class=\\\"token function\\\">dependArray</span><span class=\\\"token punctuation\\\">(</span>value<span class=\\\"token punctuation\\\">)</span></span>\\n<span class=\\\"line\\\">          <span class=\\\"token punctuation\\\">}</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token punctuation\\\">}</span></span>\\n<span class=\\\"line\\\">      <span class=\\\"token punctuation\\\">}</span></span>\\n<span class=\\\"line\\\">      <span class=\\\"token keyword\\\">return</span> value</span>\\n<span class=\\\"line\\\">    <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">,</span></span>\\n<span class=\\\"line\\\">    <span class=\\\"token function-variable function\\\">set</span><span class=\\\"token operator\\\">:</span> <span class=\\\"token keyword\\\">function</span> <span class=\\\"token function\\\">reactiveSetter</span> <span class=\\\"token punctuation\\\">(</span><span class=\\\"token parameter\\\">newVal</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">      <span class=\\\"token keyword\\\">const</span> value <span class=\\\"token operator\\\">=</span> getter <span class=\\\"token operator\\\">?</span> <span class=\\\"token function\\\">getter</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">call</span><span class=\\\"token punctuation\\\">(</span>obj<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token operator\\\">:</span> val</span>\\n<span class=\\\"line\\\">      <span class=\\\"token comment\\\">/* eslint-disable no-self-compare */</span></span>\\n<span class=\\\"line\\\">      <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>newVal <span class=\\\"token operator\\\">===</span> value <span class=\\\"token operator\\\">||</span> <span class=\\\"token punctuation\\\">(</span>newVal <span class=\\\"token operator\\\">!==</span> newVal <span class=\\\"token operator\\\">&amp;&amp;</span> value <span class=\\\"token operator\\\">!==</span> value<span class=\\\"token punctuation\\\">)</span><span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token keyword\\\">return</span></span>\\n<span class=\\\"line\\\">      <span class=\\\"token punctuation\\\">}</span></span>\\n<span class=\\\"line\\\">      <span class=\\\"token comment\\\">/* eslint-enable no-self-compare */</span></span>\\n<span class=\\\"line\\\">      <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>process<span class=\\\"token punctuation\\\">.</span>env<span class=\\\"token punctuation\\\">.</span><span class=\\\"token constant\\\">NODE_ENV</span> <span class=\\\"token operator\\\">!==</span> <span class=\\\"token string\\\">'production'</span> <span class=\\\"token operator\\\">&amp;&amp;</span> customSetter<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token function\\\">customSetter</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span></span>\\n<span class=\\\"line\\\">      <span class=\\\"token punctuation\\\">}</span></span>\\n<span class=\\\"line\\\">      <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>getter <span class=\\\"token operator\\\">&amp;&amp;</span> <span class=\\\"token operator\\\">!</span>setter<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token keyword\\\">return</span></span>\\n<span class=\\\"line\\\">      <span class=\\\"token keyword\\\">if</span> <span class=\\\"token punctuation\\\">(</span>setter<span class=\\\"token punctuation\\\">)</span> <span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">        <span class=\\\"token function\\\">setter</span><span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">call</span><span class=\\\"token punctuation\\\">(</span>obj<span class=\\\"token punctuation\\\">,</span> newVal<span class=\\\"token punctuation\\\">)</span></span>\\n<span class=\\\"line\\\">      <span class=\\\"token punctuation\\\">}</span> <span class=\\\"token keyword\\\">else</span> <span class=\\\"token punctuation\\\">{</span></span>\\n<span class=\\\"line\\\">        val <span class=\\\"token operator\\\">=</span> newVal</span>\\n<span class=\\\"line\\\">      <span class=\\\"token punctuation\\\">}</span></span>\\n<span class=\\\"line\\\">      <span class=\\\"token comment\\\">// 新的值需要重新进行observe，保证数据响应式</span></span>\\n<span class=\\\"line\\\">      childOb <span class=\\\"token operator\\\">=</span> <span class=\\\"token operator\\\">!</span>shallow <span class=\\\"token operator\\\">&amp;&amp;</span> <span class=\\\"token function\\\">observe</span><span class=\\\"token punctuation\\\">(</span>newVal<span class=\\\"token punctuation\\\">)</span></span>\\n<span class=\\\"line\\\">      <span class=\\\"token comment\\\">// 将数据变化通知所有的观察者</span></span>\\n<span class=\\\"line\\\">      dep<span class=\\\"token punctuation\\\">.</span><span class=\\\"token function\\\">notify</span><span class=\\\"token punctuation\\\">(</span><span class=\\\"token punctuation\\\">)</span></span>\\n<span class=\\\"line\\\">    <span class=\\\"token punctuation\\\">}</span></span>\\n<span class=\\\"line\\\">  <span class=\\\"token punctuation\\\">}</span><span class=\\\"token punctuation\\\">)</span></span>\\n<span class=\\\"line\\\"></span></code></pre>\\n<div class=\\\"line-numbers\\\" aria-hidden=\\\"true\\\" style=\\\"counter-reset:line-number 0\\\"><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div><div class=\\\"line-number\\\"></div></div></div>\"}")
export { comp, data }

if (import.meta.webpackHot) {
  import.meta.webpackHot.accept()
  if (__VUE_HMR_RUNTIME__.updatePageData) {
    __VUE_HMR_RUNTIME__.updatePageData(data)
  }
}

if (import.meta.hot) {
  import.meta.hot.accept(({ data }) => {
    __VUE_HMR_RUNTIME__.updatePageData(data)
  })
}
